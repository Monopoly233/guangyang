apiVersion: v1
kind: Secret
metadata:
  name: wechatpay-env
  namespace: gy
type: Opaque
stringData:
  # 回调地址（微信商户平台配置也要一致）
  WECHAT_NOTIFY_URL: "https://pay.guangyang.online/wechatpay/notify"
  # 商户号
  WECHAT_MCHID: "1106xxxxxxxx"
  # 支付 appid（优先级高于 WECHAT_APPID）
  WECHAT_PAY_APPID: "wx***************"
  # 兼容字段（可不填）
  WECHAT_APPID: ""
  # APIv3 Key（必须 32 字节）
  WECHAT_API_V3_KEY: "********************************"
  # 平台验签材料：二选一即可
  # 1) 平台公钥模式（推荐）
  WECHAT_PLATFORM_PUBLIC_KEY_ID: "PUB_KEY_ID_********"
  WECHAT_PLATFORM_PUBLIC_KEY: |
    -----BEGIN PUBLIC KEY-----
    ...
    -----END PUBLIC KEY-----
  # 2) 平台证书模式：把 platform_cert.pem 放到 wechatpay-cert secret（见下）
  # WECHAT_PLATFORM_PUBLIC_KEY_ID / WECHAT_PLATFORM_PUBLIC_KEY 可留空
  #
  # 是否走 mock（1=不真实下单，仅返回占位 code_url）
  WECHAT_MOCK: "0"

---
# 证书/私钥 Secret（不要提交真实内容到仓库！）
# 生成方式示例（在能访问集群的机器上执行）：
#
# kubectl -n gy create secret generic wechatpay-cert \
#   --from-file=merchant_key.pem=/path/to/merchant_key.pem \
#   --from-file=merchant_cert.pem=/path/to/merchant_cert.pem \
#   --from-file=platform_cert.pem=/path/to/platform_cert.pem
#
# 如果你只有商户平台下载的 zip，也可以直接把 zip 放进 secret（文件名必须匹配）：
# - <mchid>_YYYYMMDD_cert.zip（例如 1106035691_20260131_cert.zip）
# 程序会自动解压到 TMP_ROOT/wechatpay_cache/cert/ 并生成 merchant_key.pem/merchant_cert.pem。
#
# kubectl -n gy create secret generic wechatpay-cert \
#   --from-file=1106035691_20260131_cert.zip=/path/to/1106035691_20260131_cert.zip
#
# 其中：
# - merchant_key.pem / merchant_cert.pem 为商户私钥与商户证书
# - platform_cert.pem 为平台证书（如你用平台公钥模式，则可不提供此文件）
#
apiVersion: v1
kind: Secret
metadata:
  name: wechatpay-cert
  namespace: gy
type: Opaque
data: {}

